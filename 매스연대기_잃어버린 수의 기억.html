<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë§¤ìŠ¤ ì—°ëŒ€ê¸°: ìƒì–´ë²„ë¦° ìˆ˜ì˜ ê¸°ì–µ</title>
    <style>
        /* [ìŠ¤íƒ€ì¼: Artscape - ì‹ ë¹„ë¡œìš´ ê³ ëŒ€ ê¸°ë¡ ë³´ê´€ì†Œ] */
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background: linear-gradient(to right, #24243e, #302b63, #0f0c29);
            color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }
        #app-frame {
            width: 400px;
            height: 750px;
            background: rgba(0, 0, 0, 0.6);
            border: 2px solid #ffd700;
            border-radius: 15px;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
            position: relative;
            overflow: hidden;
        }

        /* ê³µí†µ UI */
        .screen {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            padding: 20px;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: opacity 0.5s;
            background-image: url('https://www.transparenttextures.com/patterns/stardust.png');
        }
        .hidden { display: none; opacity: 0; }

        h1 { color: #ffd700; font-size: 28px; text-shadow: 2px 2px 4px #000; margin-bottom: 5px; }
        .subtitle { font-size: 14px; color: #aaa; margin-bottom: 30px; font-style: italic; }

        /* ë¡œë¹„ ë²„íŠ¼ */
        .chapter-btn {
            width: 90%;
            padding: 18px;
            margin: 10px 0;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid #666;
            color: #ccc;
            border-radius: 8px;
            cursor: pointer;
            text-align: left;
            transition: 0.3s;
        }
        .chapter-btn.unlocked {
            border-color: #ffd700;
            color: #ffd700;
            background: rgba(255, 215, 0, 0.1);
        }
        .chapter-btn.locked { opacity: 0.6; cursor: not-allowed; }
        .chapter-btn small { display: block; font-size: 12px; color: #aaa; margin-top: 5px; }

        /* ê²Œì„ í™”ë©´ ìš”ì†Œ */
        .story-box {
            background: rgba(0,0,0,0.5);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 3px solid #ffd700;
            line-height: 1.5;
            font-size: 14px;
        }
        .problem-area {
            text-align: center;
            font-size: 20px;
            margin: 20px 0;
            font-weight: bold;
            background: rgba(255,255,255,0.05);
            padding: 20px;
            border-radius: 10px;
            width: 90%;
        }
        input {
            background: transparent;
            border: none;
            border-bottom: 2px solid #ffd700;
            color: white;
            font-size: 24px;
            width: 80px;
            text-align: center;
            margin-top: 10px;
        }
        input:focus { outline: none; }

        /* ê¸°ëŠ¥ ë²„íŠ¼ë“¤ */
        .btn-group { display: flex; gap: 10px; margin-top: 10px; }
        .func-btn {
            padding: 8px 12px;
            font-size: 12px;
            border-radius: 20px;
            border: none;
            cursor: pointer;
            background: #4a4a4a;
            color: white;
        }
        .btn-hint { background: #e67e22; }
        .btn-video { background: #e74c3c; }
        .btn-submit { 
            margin-top: 20px; padding: 12px 40px; 
            background: #ffd700; color: #000; font-weight: bold; font-size: 16px; 
            border-radius: 25px; border: none; cursor: pointer;
        }
        .btn-submit:hover { transform: scale(1.05); }

        #hint-box {
            margin-top: 15px;
            padding: 10px;
            background: #fff3cd;
            color: #856404;
            border-radius: 5px;
            font-size: 13px;
            display: none;
            animation: fadeIn 0.5s;
        }

        /* íŒì—… ëª¨ë‹¬ */
        .modal {
            display: none;
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 100;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            width: 90%;
            background: #222;
            padding: 10px;
            border-radius: 10px;
            text-align: center;
        }
        .close-modal {
            margin-top: 15px;
            padding: 8px 20px;
            background: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

<div id="app-frame">
    
    <div id="lobby" class="screen">
        <h1>ğŸ“œ ë§¤ìŠ¤ ì—°ëŒ€ê¸°</h1>
        <div class="subtitle">Math Chronicles: ìƒì–´ë²„ë¦° ìˆ˜ì˜ ê¸°ì–µ</div>
        
        <button class="chapter-btn unlocked" onclick="startGame(0)">
            <strong>ì„œë§‰: íƒœì´ˆì˜ ì¡°ê°</strong>
            <small>Lv.0 ê¸°ì´ˆ | ì†Œì¸ìˆ˜ë¶„í•´ì™€ ìˆ˜ì˜ ë³¸ì§ˆ</small>
        </button>
        <button class="chapter-btn locked" id="btn-lv1" onclick="startGame(1)">
            <strong>ì œ 1ì¥: ê· í˜•ì˜ ì‹œëŒ€ ğŸ”’</strong>
            <small>Lv.1 ì¤‘1 | ì¼ì°¨ë°©ì •ì‹ê³¼ ë“±ì‹</small>
        </button>
        <button class="chapter-btn locked" id="btn-lv2" onclick="startGame(2)">
            <strong>ì œ 2ì¥: ë³€í™”ì˜ ì–¸ë• ğŸ”’</strong>
            <small>Lv.2 ì¤‘2 | ì¼ì°¨í•¨ìˆ˜ì™€ ê¸°ìš¸ê¸°</small>
        </button>
        <button class="chapter-btn locked" id="btn-lv3" onclick="startGame(3)">
            <strong>ì œ 3ì¥: ì§„ë¦¬ì˜ íƒ‘ ğŸ”’</strong>
            <small>Lv.3 ì¤‘3 | í”¼íƒ€ê³ ë¼ìŠ¤ì™€ ë¬´ë¦¬ìˆ˜</small>
        </button>
    </div>

    <div id="game" class="screen hidden">
        <h2 id="stage-title" style="color:#ffd700; margin-top:0;">Chapter Title</h2>
        <div class="story-box" id="stage-story">Story...</div>

        <div class="problem-area">
            <div id="stage-problem">Problem...</div>
            <input type="number" id="user-answer" placeholder="?">
        </div>

        <div class="btn-group">
            <button class="func-btn btn-hint" onclick="toggleHint()">ğŸ’¡ íŒíŠ¸ ë³´ê¸°</button>
            <button class="func-btn btn-video" onclick="openVideo()">ğŸ“º ê°œë… ì˜ìƒ</button>
        </div>

        <div id="hint-box">íŒíŠ¸ ë‚´ìš©</div>

        <button class="btn-submit" onclick="checkAnswer()">ìš´ëª… í™•ì¸ (ì •ë‹µ)</button>
        <button class="func-btn" style="margin-top: 20px; background:transparent; border:1px solid #666;" onclick="goLobby()">ë¡œë¹„ë¡œ ëŒì•„ê°€ê¸°</button>
    </div>

    <div id="video-modal" class="modal">
        <div class="modal-content">
            <h3 style="color:white; margin-bottom:10px;">ê°œë… ì„¤ëª…</h3>
            <iframe id="youtube-frame" width="100%" height="200" src="" title="Video" frameborder="0" allowfullscreen></iframe>
            <button class="close-modal" onclick="closeVideo()">ë‹«ê¸°</button>
        </div>
    </div>

</div>

<script>
    // [ë°ì´í„°ë² ì´ìŠ¤: ê° ë‹¨ê³„ë³„ 5ë¬¸ì œì”© íƒ‘ì¬ ì™„ë£Œ]
    const chronicles = [
        {
            level: 0,
            title: "ì„œë§‰: íƒœì´ˆì˜ ì¡°ê°",
            story: "ì„¸ìƒì˜ ëª¨ë“  ìˆ˜ëŠ” ì‘ì€ ì›ì†Œë“¤ì˜ ê²°í•©ì…ë‹ˆë‹¤. í©ì–´ì§„ ìˆ˜ë“¤ì„ ì†Œì¸ìˆ˜ë¶„í•´ë¡œ ë‹¤ì‹œ ê²°í•©í•´ì£¼ì„¸ìš”.",
            videoId: "zWlXqF_TmeE",
            quizBank: [
                { q: "12 = 2Â² Ã— â–¡", a: 3, h: "12ë¥¼ 4ë¡œ ë‚˜ëˆ„ë©´ ë¬´ì—‡ì´ ë‚¨ë‚˜ìš”?" },
                { q: "18 = 2 Ã— â–¡Â²", a: 3, h: "18ì„ 2ë¡œ ë‚˜ëˆ„ë©´ 9ì…ë‹ˆë‹¤. 9ëŠ” ë¬´ì—‡ì˜ ì œê³±ì¼ê¹Œìš”?" },
                { q: "20 = 2Â² Ã— â–¡", a: 5, h: "20ì„ 4ë¡œ ë‚˜ëˆ„ë©´ ë¬´ì—‡ì¸ê°€ìš”?" },
                { q: "45 = 3Â² Ã— â–¡", a: 5, h: "3ì˜ ì œê³±ì€ 9ì…ë‹ˆë‹¤. 45 ë‚˜ëˆ„ê¸° 9ëŠ”?" },
                { q: "50 = 2 Ã— â–¡Â²", a: 5, h: "50 ë‚˜ëˆ„ê¸° 2ëŠ” 25ì…ë‹ˆë‹¤. 25ëŠ” ì–´ë–¤ ìˆ˜ì˜ ì œê³±ì¼ê¹Œìš”?" }
            ]
        },
        {
            level: 1,
            title: "ì œ 1ì¥: ê· í˜•ì˜ ì‹œëŒ€",
            story: "í‰í™”ë¡­ë˜ ì‹œëŒ€ì— ê· í˜•ì´ ê¹¨ì¡ŒìŠµë‹ˆë‹¤. ì €ìš¸(ë“±í˜¸)ì˜ ìˆ˜í‰ì„ ë§ì¶”ê¸° ìœ„í•´ ë¯¸ì§€ìˆ˜ xë¥¼ ì°¾ì•„ì•¼ í•©ë‹ˆë‹¤.",
            videoId: "9c3j8Cg63kE",
            quizBank: [
                { q: "3x + 4 = 19<br>xì˜ ê°’ì€?", a: 5, h: "ì–‘ë³€ì—ì„œ 4ë¥¼ ë¨¼ì € ë¹¼ë³´ì„¸ìš”. 3x = 15" },
                { q: "2x - 5 = 5<br>xì˜ ê°’ì€?", a: 5, h: "-5ë¥¼ ì—†ì• ë ¤ë©´ ì–‘ë³€ì— 5ë¥¼ ë”í•˜ì„¸ìš”." },
                { q: "4x = 20<br>xì˜ ê°’ì€?", a: 5, h: "20ì„ 4ë¡œ ë‚˜ëˆ„ë©´ xê°€ ë‚˜ì˜µë‹ˆë‹¤." },
                { q: "5x + 2 = 12<br>xì˜ ê°’ì€?", a: 2, h: "12ì—ì„œ 2ë¥¼ ë¹¼ë©´ 10ì…ë‹ˆë‹¤. 5x=10" },
                { q: "2x + 3 = 11<br>xì˜ ê°’ì€?", a: 4, h: "11ì—ì„œ 3ì„ ë¹¼ë©´ 8ì…ë‹ˆë‹¤. 2x=8" }
            ]
        },
        {
            level: 2,
            title: "ì œ 2ì¥: ë³€í™”ì˜ ì–¸ë•",
            story: "ë³€ìˆ˜ë“¤ì´ ì„œë¡œ ì˜í–¥ì„ ì£¼ê¸° ì‹œì‘í–ˆìŠµë‹ˆë‹¤. ì…ë ¥(x)ì´ ë³€í•  ë•Œ ì¶œë ¥(y)ì´ ì–´ë–»ê²Œ ë³€í•˜ëŠ”ì§€ ê·œì¹™ì„ ì°¾ìœ¼ì„¸ìš”.",
            videoId: "PjJ2_WJ9QfE",
            quizBank: [
                { q: "y = 2x + 1<br>xê°€ 3ì¼ ë•Œ, yëŠ”?", a: 7, h: "x ìë¦¬ì— 3ì„ ë„£ìœ¼ì„¸ìš”. (2Ã—3)+1" },
                { q: "y = 3x - 2<br>xê°€ 2ì¼ ë•Œ, yëŠ”?", a: 4, h: "(3Ã—2) - 2ë¥¼ ê³„ì‚°í•´ë³´ì„¸ìš”." },
                { q: "ì¼ì°¨í•¨ìˆ˜ y = ax + 3 ì´<br>(1, 5)ë¥¼ ì§€ë‚  ë•Œ aëŠ”?", a: 2, h: "yì— 5, xì— 1ì„ ë„£ìœ¼ì„¸ìš”. 5 = a + 3" },
                { q: "y = -x + 10<br>xê°€ 3ì¼ ë•Œ, yëŠ”?", a: 7, h: "10ì—ì„œ 3ì„ ë¹¼ë³´ì„¸ìš”." },
                { q: "ë‘ ì  (1,1), (2,3)ì„ ì§€ë‚˜ëŠ”<br>ì§ì„ ì˜ ê¸°ìš¸ê¸°ëŠ”?", a: 2, h: "yì˜ ì¦ê°€ëŸ‰(3-1) ë‚˜ëˆ„ê¸° xì˜ ì¦ê°€ëŸ‰(2-1)" }
            ]
        },
        {
            level: 3,
            title: "ì œ 3ì¥: ì§„ë¦¬ì˜ íƒ‘",
            story: "ë³€í•˜ì§€ ì•ŠëŠ” ì§„ë¦¬ë¥¼ ì°¾ì•„ì•¼ í•©ë‹ˆë‹¤. í”¼íƒ€ê³ ë¼ìŠ¤ì˜ í˜ì„ ë¹Œë ¤ ë¬´ë¦¬ìˆ˜ì˜ ë¹„ë°€ì„ ë°íˆì„¸ìš”.",
            videoId: "A9GjPj8P_34",
            quizBank: [
                { q: "ë°‘ë³€ 3, ë†’ì´ 4ì¸ ì§ê°ì‚¼ê°í˜•<br>ë¹—ë³€ì˜ ê¸¸ì´ëŠ”?", a: 5, h: "3Â² + 4Â² = â–¡Â² (9+16=25)" },
                { q: "ë°‘ë³€ 6, ë†’ì´ 8ì¸ ì§ê°ì‚¼ê°í˜•<br>ë¹—ë³€ì˜ ê¸¸ì´ëŠ”?", a: 10, h: "6Â² + 8Â² = 100 ì…ë‹ˆë‹¤." },
                { q: "âˆš16 + âˆš9 ì˜ ê°’ì€?", a: 7, h: "ë£¨íŠ¸ 16ì€ 4, ë£¨íŠ¸ 9ëŠ” 3ì…ë‹ˆë‹¤." },
                { q: "ë°‘ë³€ 5, ë†’ì´ 12ì¸ ì§ê°ì‚¼ê°í˜•<br>ë¹—ë³€ì˜ ê¸¸ì´ëŠ”?", a: 13, h: "5Â²(25) + 12Â²(144) = 169" },
                { q: "âˆš25 - âˆš4 ì˜ ê°’ì€?", a: 3, h: "5 ë¹¼ê¸° 2ë¥¼ ê³„ì‚°í•˜ì„¸ìš”." }
            ]
        }
    ];

    let currentStage = 0;
    let unlockedStage = 0;
    let currentQuiz = null;

    function startGame(idx) {
        if (idx > unlockedStage) {
            alert("ì´ì „ ì‹œëŒ€ì˜ ì—­ì‚¬ë¥¼ ë¨¼ì € ì™„ì„±í•´ì•¼ í•©ë‹ˆë‹¤!");
            return;
        }
        currentStage = idx;
        const data = chronicles[idx];

        document.getElementById('lobby').classList.add('hidden');
        document.getElementById('game').classList.remove('hidden');

        // [í•µì‹¬] ëœë¤ ë¬¸ì œ ì¶œì œ
        const randomIndex = Math.floor(Math.random() * data.quizBank.length);
        currentQuiz = data.quizBank[randomIndex];

        document.getElementById('stage-title').innerText = data.title;
        document.getElementById('stage-story').innerText = data.story;
        document.getElementById('stage-problem').innerHTML = currentQuiz.q;
        document.getElementById('user-answer').value = "";
        
        document.getElementById('hint-box').style.display = 'none';
        document.getElementById('hint-box').innerText = currentQuiz.h;
    }

    function checkAnswer() {
        const userVal = parseInt(document.getElementById('user-answer').value);
        
        if (userVal === currentQuiz.a) {
            alert(`[ì •ë‹µì…ë‹ˆë‹¤!] \n\nì—­ì‚¬ì˜ í•œ í˜ì´ì§€ê°€ ë³µêµ¬ë˜ì—ˆìŠµë‹ˆë‹¤.\n"${chronicles[currentStage].title}" í´ë¦¬ì–´!`);
            
            if (currentStage === unlockedStage && currentStage < 3) {
                unlockedStage++;
                updateLobby();
            }
            goLobby();
        } else {
            alert("í‹€ë ¸ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ê³„ì‚°í•´ë³´ê±°ë‚˜ íŒíŠ¸ë¥¼ í™•ì¸í•˜ì„¸ìš”!");
        }
    }

    function toggleHint() {
        const box = document.getElementById('hint-box');
        box.style.display = (box.style.display === 'block') ? 'none' : 'block';
    }

    function openVideo() {
        const data = chronicles[currentStage];
        const modal = document.getElementById('video-modal');
        const iframe = document.getElementById('youtube-frame');
        iframe.src = `https://www.youtube.com/embed/${data.videoId}`;
        modal.style.display = 'flex';
    }

    function closeVideo() {
        const modal = document.getElementById('video-modal');
        const iframe = document.getElementById('youtube-frame');
        iframe.src = "";
        modal.style.display = 'none';
    }

    function updateLobby() {
        for(let i=1; i<=3; i++) {
            const btn = document.getElementById(`btn-lv${i}`);
            if (i <= unlockedStage) {
                btn.classList.remove('locked');
                btn.classList.add('unlocked');
                btn.innerHTML = btn.innerHTML.replace('ğŸ”’', '');
            }
        }
    }

    function goLobby() {
        document.getElementById('game').classList.add('hidden');
        document.getElementById('lobby').classList.remove('hidden');
    }
</script>

</body>
</html>