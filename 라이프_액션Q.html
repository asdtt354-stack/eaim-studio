<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Life Action Q - ê°€ì • ìƒí™œ ì‹¤ì²œ ë³¸ë¶€</title>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        /* [1] ê¸°ë³¸ ë””ìì¸ */
        body {
            font-family: 'Pretendard', 'Malgun Gothic', sans-serif;
            background-color: #f0f4f8;
            color: #333;
            margin: 0;
            padding: 20px;
            display: flex; flex-direction: column; align-items: center;
        }

        h1 { color: #2c3e50; border-bottom: 3px solid #e67e22; padding-bottom: 10px; }

        .container {
            background: white; width: 100%; max-width: 600px;
            padding: 30px; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        .step-box {
            margin-bottom: 25px; padding: 20px; background: #eef2f5;
            border-radius: 15px; border-left: 5px solid #3498db;
        }

        h3 { margin-top: 0; color: #34495e; }
        label { display: block; margin-bottom: 8px; font-weight: bold; }
        
        select, input[type="text"], textarea {
            width: 100%; padding: 12px; margin-bottom: 10px;
            border: 1px solid #bdc3c7; border-radius: 8px; box-sizing: border-box; font-size: 1rem;
        }

        /* [2] ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .value-btn-group { display: flex; gap: 10px; margin-bottom: 15px; }
        .value-btn {
            flex: 1; padding: 10px; border: none; border-radius: 10px;
            cursor: pointer; font-weight: bold; transition: 0.3s; background: #ddd;
        }
        .value-btn.active { transform: scale(1.05); color: white; box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
        
        #btn-ye.active { background: #e74c3c; } 
        #btn-hyo.active { background: #f1c40f; color: #333; } 
        #btn-jeong.active { background: #3498db; } 
        #btn-chae.active { background: #2ecc71; } 

        .music-section { background: #2c3e50; color: white; padding: 15px; border-radius: 10px; margin-top: 10px; }
        .music-section a { color: #f1c40f; text-decoration: none; font-weight: bold; }

        .btn-generate {
            width: 100%; padding: 15px; background: #333; color: white;
            font-size: 1.2rem; border: none; border-radius: 10px; cursor: pointer; font-weight: bold;
        }
        .btn-generate:hover { background: #555; }

        /* [3] ê²°ê³¼ ì¹´ë“œ (í‹°ì¼“) ë””ìì¸ */
        .mission-ticket {
            display: none; /* ì²˜ìŒì—” ìˆ¨ê¹€ */
            background: white; border: 3px dashed #333;
            padding: 30px; margin-top: 20px; position: relative;
        }
        .mission-ticket::before {
            content: "Action Ticket"; position: absolute; top: -15px; left: 50%; transform: translateX(-50%);
            background: #333; color: white; padding: 5px 15px; font-weight: bold; border-radius: 20px;
        }

        /* [4] ì €ì¥/ì¸ì‡„ ë²„íŠ¼ (í‹°ì¼“ ë°œê¶Œ í›„ ë³´ì„) */
        .save-actions {
            display: none; gap: 10px; margin-top: 20px;
        }
        .btn-action {
            flex: 1; padding: 12px; border: none; border-radius: 8px;
            font-weight: bold; cursor: pointer; color: white; font-size: 1rem;
        }
        .btn-print { background-color: #2980b9; }
        .btn-save { background-color: #27ae60; }

        /* [5] ì¸ì‡„ ì „ìš© ìŠ¤íƒ€ì¼ (ì¢…ì´ë¡œ ë½‘ì„ ë•Œ) */
        @media print {
            body * { visibility: hidden; } /* ëª¨ë“  ìš”ì†Œ ìˆ¨ê¹€ */
            .mission-ticket, .mission-ticket * { visibility: visible; } /* í‹°ì¼“ë§Œ ë³´ì„ */
            .mission-ticket { 
                position: absolute; left: 0; top: 0; width: 100%; margin: 0; border: 2px solid #000; 
            }
            .container, h1, p, .save-actions { display: none; } /* ì¡ë‹¤í•œ ê²ƒ ìˆ¨ê¹€ */
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>Life Action Q ğŸ </h1>
        <p>EAIM ê°€ì • ìˆ˜ì—…: ë§ˆìŒì„ í–‰ë™ìœ¼ë¡œ ì‹¤ì²œí•˜ê¸°</p>
        
        <div class="step-box">
            <h3>1. ì˜¤ëŠ˜ì˜ ìˆ˜ë ¨ ê°€ì¹˜ (Value)</h3>
            <div class="value-btn-group">
                <button class="value-btn" id="btn-ye" onclick="selectValue('ye', 'ì‹ì‚¬ ì˜ˆì ˆ & ì¸ì‚¬')">ì˜ˆ (Ye)</button>
                <button class="value-btn" id="btn-hyo" onclick="selectValue('hyo', 'ë¶€ëª¨ë‹˜ ë•ê¸°')">íš¨ (Hyo)</button>
                <button class="value-btn" id="btn-jeong" onclick="selectValue('jeong', 'ì†”ì§í•œ ëŒ€í™”')">ì •ì§ (Honesty)</button>
                <button class="value-btn" id="btn-chae" onclick="selectValue('chae', 'ì²­ì†Œ & ì •ë¦¬')">ì±…ì„ (Job)</button>
            </div>
            <p id="value-desc" style="font-size:0.9rem; color:#666;">* ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.</p>
        </div>

        <div class="step-box">
            <h3>2. í–‰ë™ ì„¤ê³„ (Action Plan)</h3>
            <label>ì–¸ì œ (Time & Place)</label>
            <input type="text" id="actionTime" placeholder="ì˜ˆ: ì˜¤ëŠ˜ ì €ë… 7ì‹œ ì‹íƒì—ì„œ">
            
            <label>ë¬´ì—‡ì„ (Specific Action)</label>
            <input type="text" id="actionWhat" placeholder="êµ¬ì²´ì ì¸ í–‰ë™ì„ ì ì–´ì£¼ì„¸ìš”.">
            
            <label>ì–´ë–»ê²Œ (Method & Skill)</label>
            <textarea id="actionHow" rows="2" placeholder="ì˜ˆ: ë‘ ì†ìœ¼ë¡œ ê³µì†í•˜ê²Œ ë¬¼ê±´ì„ ë“œë¦°ë‹¤."></textarea>
        </div>

        <div class="step-box">
            <h3>3. ì•¡ì…˜ BGM (Musicalization)</h3>
            <div class="music-section">
                <p>ğŸ¶ ì´ í–‰ë™ì„ í•  ë•Œ ë“¤ì„ ìŒì•…ì„ ì¤€ë¹„í•´ìš”.</p>
                <input type="text" id="bgmTitle" placeholder="BGM ì œëª© (ì˜ˆ: ì„¤ê±°ì§€ ë…¸ë™ìš” vol.1)" style="width:100%; color:black;">
            </div>
        </div>

        <button class="btn-generate" onclick="generateTicket()">ğŸ« ì‹¤ì²œ í‹°ì¼“ ë°œê¶Œí•˜ê¸°</button>

        <div id="ticketArea">
            <div class="mission-ticket" id="ticketResult">
                <h2 style="text-align:center; color:#e67e22; margin-top:10px;">âœ¨ MISSION CARD âœ¨</h2>
                <p><strong>ğŸ˜ í”Œë ˆì´ì–´:</strong> <span>ë‚˜ (Student)</span></p>
                <p><strong>ğŸ¯ ëª©í‘œ ê°€ì¹˜:</strong> <span id="ticketValue"></span></p>
                <hr style="border:1px dashed #ddd;">
                <p><strong>â° ì–¸ì œ:</strong> <span id="ticketTime"></span></p>
                <p><strong>ğŸ› ï¸ í–‰ë™:</strong> <span id="ticketAction" style="font-size:1.2rem; font-weight:bold; color:#2c3e50;"></span></p>
                <p><strong>ğŸ“ ë°©ë²•:</strong> <span id="ticketMethod"></span></p>
                <hr style="border:1px dashed #ddd;">
                <p><strong>ğŸ§ BGM:</strong> <span id="ticketBGM"></span></p>
                <div style="text-align:center; margin-top:20px; font-size:40px;">ğŸ”¥</div>
                <p style="text-align:center; color:#888; font-size:0.8rem;">EAIM ê°€ì • ì‹¤ì²œ í”„ë¡œì íŠ¸</p>
            </div>
        </div>

        <div class="save-actions" id="saveBox">
            <button class="btn-action btn-print" onclick="window.print()">ğŸ–¨ï¸ ì¸ì‡„ / PDF ì €ì¥</button>
            <button class="btn-action btn-save" onclick="saveAsImage()">ğŸ’¾ ì´ë¯¸ì§€ë¡œ ì €ì¥</button>
        </div>

    </div>

    <script>
        let selectedValue = '';

        // [1] ê°€ì¹˜ ì„ íƒ í•¨ìˆ˜
        function selectValue(val, text) {
            selectedValue = text;
            
            // ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì´ˆê¸°í™”
            document.querySelectorAll('.value-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById('btn-' + val).classList.add('active');

            // íŒíŠ¸ ë³€ê²½
            const whatInput = document.getElementById('actionWhat');
            const howInput = document.getElementById('actionHow');

            if(val === 'ye') {
                whatInput.placeholder = "ì˜ˆ: ìˆ˜ì € ë†“ê¸°, í˜„ê´€ ì‹ ë°œ ì •ë¦¬";
                howInput.placeholder = "ì˜ˆ: ì†Œë¦¬ ë‚˜ì§€ ì•Šê²Œ ì‚´ì§, ê°€ì§€ëŸ°íˆ ë†“ëŠ”ë‹¤.";
            } else if(val === 'hyo') {
                whatInput.placeholder = "ì˜ˆ: ì–´ê¹¨ ì£¼ë¬¼ëŸ¬ ë“œë¦¬ê¸°, ì„¤ê±°ì§€ ë•ê¸°";
                howInput.placeholder = "ì˜ˆ: 'ì‹œì›í•˜ì‹œì£ ?'ë¼ê³  ë¬¼ìœ¼ë©° 3ë¶„ê°„ í•œë‹¤.";
            } else if(val === 'jeong') {
                whatInput.placeholder = "ì˜ˆ: ì‹¤ìˆ˜ ì†”ì§íˆ ë§í•˜ê¸°";
                howInput.placeholder = "ì˜ˆ: ë³€ëª… ì—†ì´ 'ì œ ì˜ëª»ì…ë‹ˆë‹¤'ë¼ê³  ë§í•œë‹¤.";
            } else if(val === 'chae') {
                whatInput.placeholder = "ì˜ˆ: ë‚´ ë°© í™˜ê¸°í•˜ê¸°, ë¹¨ë˜ ê°œê¸°";
                howInput.placeholder = "ì˜ˆ: ê°ì„ ë§ì¶°ì„œ ë„¤ëª¨ë‚˜ê²Œ ê° ë‹¤.";
            }
            document.getElementById('value-desc').innerText = `ì„ íƒ: [${text}]`;
        }

        // [2] í‹°ì¼“ ìƒì„± í•¨ìˆ˜
        function generateTicket() {
            if(!selectedValue) {
                alert("1ë²ˆ 'ì˜¤ëŠ˜ì˜ ê°€ì¹˜'ë¥¼ ë¨¼ì € ì„ íƒí•´ì£¼ì„¸ìš”!"); return;
            }
            
            // ë‚´ìš© ê°€ì ¸ì˜¤ê¸°
            const time = document.getElementById('actionTime').value;
            const what = document.getElementById('actionWhat').value;
            const how = document.getElementById('actionHow').value;
            const bgm = document.getElementById('bgmTitle').value;

            if(!what) { alert("ë¬´ì—‡ì„ í• ì§€ ì ì–´ì£¼ì„¸ìš”."); return; }

            // ë‚´ìš© ë„£ê¸°
            document.getElementById('ticketValue').innerText = selectedValue;
            document.getElementById('ticketTime').innerText = time || "ì˜¤ëŠ˜ ì¤‘ ì–¸ì œë“ ";
            document.getElementById('ticketAction').innerText = what;
            document.getElementById('ticketMethod').innerText = how || "ì •ì„±ì„ ë‹¤í•´ì„œ";
            document.getElementById('ticketBGM').innerText = bgm || "í˜„ì¥ ë¼ì´ë¸Œ ì‚¬ìš´ë“œ";

            // í™”ë©´ì— í‘œì‹œ
            const ticket = document.getElementById('ticketResult');
            const saveBox = document.getElementById('saveBox');
            
            ticket.style.display = 'block';
            saveBox.style.display = 'flex'; // ì €ì¥ ë²„íŠ¼ ë³´ì´ê¸°
            
            // ìŠ¤í¬ë¡¤ ì´ë™
            saveBox.scrollIntoView({behavior: "smooth"});
        }

        // [3] ì´ë¯¸ì§€ ì €ì¥ í•¨ìˆ˜ (html2canvas ì‚¬ìš©)
        function saveAsImage() {
            const ticketElement = document.getElementById("ticketResult");
            
            // ìº¡ì²˜ ì‹œì‘
            html2canvas(ticketElement).then(canvas => {
                const link = document.createElement("a");
                document.body.appendChild(link);
                link.download = "ë‚˜ì˜_ì‹¤ì²œ_í‹°ì¼“.png"; // ë‹¤ìš´ë¡œë“œ íŒŒì¼ëª…
                link.href = canvas.toDataURL("image/png");
                link.target = '_blank';
                link.click();
                document.body.removeChild(link);
            });
        }
    </script>
</body>
</html>