<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Vibe Runway - Pro Edition (Save Feature)</title>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        /* [1] ì „ì²´ ë””ìì¸ */
        body {
            font-family: 'Pretendard', sans-serif;
            background-color: #121212;
            color: white;
            margin: 0; padding: 20px;
            display: flex; flex-direction: column; align-items: center;
        }

        h1 {
            color: #FF00FF; text-shadow: 0 0 15px #FF00FF;
            font-style: italic; margin-bottom: 5px;
        }

        .subtitle { color: #aaa; margin-bottom: 30px; font-size: 0.9rem; }

        /* [2] ë ˆì´ì•„ì›ƒ */
        .container {
            display: flex; flex-wrap: wrap; gap: 40px;
            justify-content: center; width: 100%; max-width: 1200px;
        }

        /* ì»¨íŠ¸ë¡¤ íŒ¨ë„ */
        .control-panel {
            background: #252525; padding: 25px; border-radius: 20px;
            width: 340px; box-shadow: 0 10px 20px rgba(0,0,0,0.5); height: fit-content;
        }

        .section-title {
            color: #FFD700; border-bottom: 2px solid #444; padding-bottom: 5px;
            margin-top: 30px; margin-bottom: 10px; font-weight: bold; font-size: 1.1rem;
        }
        .section-title:first-child { margin-top: 0; }

        select, input[type="file"], input[type="text"], textarea {
            width: 100%; padding: 10px; background: #333; border: 1px solid #555;
            color: white; border-radius: 8px; margin-bottom: 10px;
            box-sizing: border-box; font-family: 'Pretendard', sans-serif; font-size: 0.9rem;
        }
        
        textarea { resize: vertical; line-height: 1.5; min-height: 70px; }

        /* Suno ê°€ì´ë“œ ë°•ìŠ¤ */
        .suno-guide {
            background: #2c2c54; border: 1px dashed #706fd3; padding: 12px;
            border-radius: 8px; margin-bottom: 10px; font-size: 0.85rem; color: #d1ccc0; line-height: 1.6;
        }
        .suno-guide strong { color: #00FFFF; }
        .keyword-tag { background: #40407a; padding: 2px 6px; border-radius: 4px; color: #fff; margin-right: 3px; font-size: 0.8rem; }

        /* ë²„íŠ¼ë¥˜ */
        .pinterest-box { display: flex; gap: 5px; margin-bottom: 15px; }
        .btn-pinterest { background: #E60023; color: white; border: none; border-radius: 8px; width: 80px; cursor: pointer; font-weight: bold; }
        .btn-runway {
            background: linear-gradient(90deg, #FF00FF, #00FFFF); border: none; color: #000;
            font-weight: bold; padding: 15px; width: 100%; border-radius: 50px; font-size: 1.2rem;
            cursor: pointer; margin-top: 10px; transition: transform 0.2s; box-shadow: 0 0 15px rgba(255, 0, 255, 0.5);
        }
        .btn-runway:hover { transform: scale(1.05); }

        .btn-report {
            background: #4CAF50; color: white; border: none; padding: 15px; width: 100%;
            border-radius: 10px; font-size: 1.1rem; font-weight: bold; cursor: pointer; margin-top: 20px;
        }
        .btn-report:hover { background: #45a049; }

        .suno-link {
            display: block; text-align: center; background: #444; color: #fff;
            text-decoration: none; padding: 10px; border-radius: 5px; font-weight:bold; margin-bottom: 10px;
        }
        .suno-link:hover { background: #666; }

        /* [3] ë¬´ëŒ€ ë””ìì¸ */
        .stage-box {
            position: relative; width: 400px; height: 600px;
            background: linear-gradient(to bottom, #000, #222); border: 4px solid #444; border-radius: 20px;
            overflow: hidden; box-shadow: 0 0 50px rgba(0,0,0,0.8); perspective: 800px;
        }

        .spotlight {
            position: absolute; top: -100px; left: 50%; transform: translateX(-50%);
            width: 0; height: 0; border-left: 200px solid transparent; border-right: 200px solid transparent;
            border-bottom: 900px solid rgba(255, 255, 255, 0.15); z-index: 2; opacity: 0; transition: opacity 1s; pointer-events: none;
        }

        .character-container {
            position: absolute; bottom: 50px; left: 50%; transform: translateX(-50%) scale(0.4); opacity: 0;
            width: 150px; height: 350px; z-index: 10;
        }

        .walking-animation { animation: walkForward 8s ease-out forwards; }
        @keyframes walkForward {
            0% { transform: translateX(-50%) scale(0.4) translateY(-30px); opacity: 0; filter: blur(5px); }
            15% { opacity: 1; }
            100% { transform: translateX(-50%) scale(1.2) translateY(30px); opacity: 1; filter: blur(0); }
        }

        .head { width: 60px; height: 70px; background: #FFDAB9; border-radius: 30px; margin: 0 auto; position: relative; z-index: 5; }
        .hair { width: 70px; height: 50px; background: #333; border-radius: 35px 35px 0 0; position: absolute; top: -10px; left: -5px; }
        .body-torso { width: 80px; height: 120px; background: #fff; margin: -10px auto 0; border-radius: 15px; position: relative; z-index: 4; transition: background 0.3s; }
        .legs { width: 80px; height: 160px; background: #444; margin: -10px auto 0; border-radius: 0 0 15px 15px; position: relative; z-index: 3; transition: background 0.3s; }
        .arm-left, .arm-right { width: 20px; height: 100px; background: #FFDAB9; position: absolute; top: 20px; border-radius: 10px; }
        .arm-left { left: -15px; } .arm-right { right: -15px; }

        .tip-box { background: #444; color: #FFD700; padding: 10px; border-radius: 8px; font-size: 0.9rem; margin-top: 10px; display: none; }
        #musicStatus { position: absolute; bottom: 20px; width: 100%; text-align: center; font-size: 1.1rem; color: #00FFFF; text-shadow: 0 0 5px #000; display: none; }

        /* [4] ìµœì¢… ë³´ê³ ì„œ ëª¨ë‹¬ */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.85); z-index: 1000;
            display: none; justify-content: center; align-items: center;
        }
        .report-card {
            background: white; color: #333; width: 600px; padding: 40px;
            border-radius: 15px; box-shadow: 0 0 30px rgba(255, 255, 255, 0.2);
            text-align: left; position: relative; max-height: 90vh; overflow-y: auto;
        }
        .report-card h2 { text-align: center; border-bottom: 2px solid #333; padding-bottom: 15px; margin-top: 0; color: #000; }
        .report-item { margin-bottom: 20px; border-bottom: 1px dashed #ddd; padding-bottom: 15px; }
        .report-label { font-weight: bold; color: #2c3e50; display: block; margin-bottom: 8px; font-size: 1.1rem; }
        .report-content { background: #f8f9fa; padding: 15px; border-radius: 8px; font-size: 1rem; line-height: 1.6; white-space: pre-wrap; }
        .close-btn {
            position: absolute; top: 15px; right: 20px; font-size: 2.5rem; cursor: pointer; color: #aaa; transition: 0.2s;
        }
        .close-btn:hover { color: #000; }

        /* [ì¶”ê°€] ëª¨ë‹¬ í•˜ë‹¨ ì €ì¥/ì¸ì‡„ ë²„íŠ¼ ì˜ì—­ */
        .report-actions {
            display: flex; gap: 10px; margin-top: 20px; border-top: 1px solid #eee; padding-top: 20px;
        }
        .btn-action {
            flex: 1; padding: 12px; border: none; border-radius: 8px;
            font-weight: bold; cursor: pointer; color: white; font-size: 1rem;
        }
        .btn-print { background-color: #2980b9; }
        .btn-save { background-color: #27ae60; }

        /* [ì¤‘ìš”] ì¸ì‡„ ì‹œ ìŠ¤íƒ€ì¼ (ì¢…ì´ë¡œ ì¶œë ¥ë  ë•Œ) */
        @media print {
            body * { visibility: hidden; } /* ê¸°ë³¸ì ìœ¼ë¡œ ë‹¤ ìˆ¨ê¹€ */
            .modal-overlay, .report-card, .report-card * { 
                visibility: visible; /* ë³´ê³ ì„œë§Œ ë³´ì„ */
            }
            .modal-overlay {
                background: none; position: absolute; left: 0; top: 0; width: 100%; display: block !important;
            }
            .report-card {
                position: absolute; left: 0; top: 0; width: 100%; margin: 0; padding: 0; 
                box-shadow: none; border: 2px solid #000;
            }
            /* ì¸ì‡„í•  ë•Œ ìˆ¨ê¸¸ ê²ƒë“¤ (ë‹«ê¸° ë²„íŠ¼, ì €ì¥ ë²„íŠ¼ ë“±) */
            .close-btn, .report-actions { display: none !important; }
            .report-content { border: 1px solid #ccc; background: none; } /* ì‰í¬ ì ˆì•½ */
        }
    </style>
</head>
<body>

    <h1>My Vibe Runway</h1>
    <p class="subtitle">EAIM ì˜ìƒí™œ í”„ë¡œì íŠ¸: ë‚˜ë§Œì˜ ìŠ¤íƒ€ì¼ê³¼ ìŒì•…ì„ ì—°ì¶œí•˜ë‹¤</p>

    <div class="container">
        <div class="control-panel">
            
            <div class="section-title">1. TPO (ìƒí™© ì„¤ì •)</div>
            <select id="tpoSelect" onchange="checkTPO()">
                <option value="">ìƒí™©ì„ ì„ íƒí•˜ì„¸ìš”</option>
                <option value="school">ğŸ« í•™êµ ë°œí‘œ/ë“±êµ</option>
                <option value="date">ğŸŒ³ ì£¼ë§ ë°ì´íŠ¸</option>
                <option value="party">ğŸ‰ ì¶•ì œ/íŒŒí‹°</option>
                <option value="interview">ğŸ‘” ë©´ì ‘/ê³µì‹í–‰ì‚¬</option>
            </select>
            <div id="tipBox" class="tip-box"></div>

            <div class="section-title">2. ì•„ì´ë””ì–´ ê²€ìƒ‰ (Pinterest)</div>
            <div class="pinterest-box">
                <input type="text" id="pinSearch" placeholder="ì˜ˆ: 10ëŒ€ ë°ì´íŠ¸ë£©">
                <button class="btn-pinterest" onclick="searchPinterest()">ê²€ìƒ‰</button>
            </div>

            <div class="section-title">3. ìŠ¤íƒ€ì¼ë§ (Artscape)</div>
            <label>ğŸ‘• ìƒì˜</label>
            <select id="topColor" onchange="changeClothes()">
                <option value="#ffffff">ğŸ¤ í™”ì´íŠ¸</option>
                <option value="#000000">ğŸ–¤ ë¸”ë™</option>
                <option value="#ff9ff3">ğŸ’— í•‘í¬</option>
                <option value="#48dbfb">ğŸ’™ ìŠ¤ì¹´ì´ë¸”ë£¨</option>
                <option value="#ff4757">â¤ï¸ ë ˆë“œ</option>
                <option value="#2ed573">ğŸ’š ê·¸ë¦°</option>
            </select>

            <label>ğŸ‘– í•˜ì˜</label>
            <select id="bottomColor" onchange="changeClothes()">
                <option value="#333333">ğŸ‘– ë‹¤í¬ ê·¸ë ˆì´</option>
                <option value="#54a0ff">ğŸ‘– ë°ë‹˜ ë¸”ë£¨</option>
                <option value="#feca57">âœ¨ ì˜ë¡œìš°</option>
                <option value="#f1f2f6">ğŸ¤ í™”ì´íŠ¸</option>
                <option value="#574b90">ğŸ’œ í¼í”Œ</option>
            </select>

            <div class="section-title">4. ì‚¬ìš´ë“œ (Musicalization)</div>
            <div class="suno-guide">
                <strong>ğŸ’¡ Suno ë°°ê²½ìŒì•… ì œì‘ íŒ</strong><br>
                1. <strong>[Create]</strong> â†’ <strong>[Simple]</strong> ëª¨ë“œ ì¼œê¸°<br>
                2. <strong>[Instrumental]</strong> ë²„íŠ¼ í™œì„±í™” (ì¤‘ìš”!)<br>
                3. ì›í•˜ëŠ” <strong>ë¶„ìœ„ê¸°(Style of Music)</strong> ì…ë ¥<br>
                ğŸ‘‰ ì˜ˆì‹œ: <span class="keyword-tag">Fashion show</span> <span class="keyword-tag">Fast tempo</span> <span class="keyword-tag">Upbeat EDM</span> <span class="keyword-tag">Elegant Piano</span>
            </div>
            <a href="https://suno.com" target="_blank" class="suno-link">ğŸµ Suno.com ë°”ë¡œê°€ê¸°</a>
            <input type="file" id="musicFile" accept="audio/*">
            <button class="btn-runway" onclick="startRunway()">ğŸ¬ ëŸ°ì›¨ì´ & ìŒì•… í!</button>
            <audio id="audioPlayer"></audio>

            <div class="section-title">5. ë””ìì´ë„ˆ ë…¸íŠ¸ (ê¸°íšì„œ)</div>
            <p style="font-size:0.8rem; color:#aaa; margin-bottom:10px;">* ë‚˜ì˜ ê¸°íš ì˜ë„ë¥¼ êµ¬ì²´ì ìœ¼ë¡œ ì ì–´ì£¼ì„¸ìš”.</p>
            
            <label style="font-size:0.85rem; color:#ccc;">Q1. TPOì™€ ìŠ¤íƒ€ì¼ë§: ì™œ ì´ ìƒí™©ì— ì´ ìƒ‰ê¹”ì˜ ì˜·ì„ ì„ íƒí–ˆë‚˜ìš”?</label>
            <textarea id="essay_tpo" placeholder="ì˜ˆ: ì¦ê±°ìš´ íŒŒí‹° ë¶„ìœ„ê¸°ë¥¼ ìœ„í•´ ë°ì€ ë…¸ë€ìƒ‰ì„ ì¼ìŠµë‹ˆë‹¤."></textarea>
            
            <label style="font-size:0.85rem; color:#ccc; margin-top:5px; display:block;">Q2. ìŒì•… ì„ íƒ ì´ìœ : ì´ ìŒì•…ì˜ ë¶„ìœ„ê¸°ê°€ ë‚´ íŒ¨ì…˜ê³¼ ì–´ë–»ê²Œ ì–´ìš¸ë¦¬ë‚˜ìš”?</label>
            <textarea id="essay_music" placeholder="ì˜ˆ: ë‹¹ë‹¹í•œ ê±¸ìŒê±¸ì´ë¥¼ ìœ„í•´ ë¹„íŠ¸ê°€ ë¹ ë¥´ê³  ê°•ë ¬í•œ EDMì„ ê³¨ëìŠµë‹ˆë‹¤."></textarea>

            <label style="font-size:0.85rem; color:#ccc; margin-top:5px; display:block;">Q3. ìµœì¢… Vibe: ì´ ëŸ°ì›¨ì´ë¥¼ í†µí•´ ì‚¬ëŒë“¤ì—ê²Œ ë³´ì—¬ì£¼ê³  ì‹¶ì€ ë‚˜ì˜ ì´ë¯¸ì§€ëŠ”?</label>
            <textarea id="essay_vibe" placeholder="ì˜ˆ: 'ìì‹ ê° ë„˜ì¹˜ëŠ” ë‚˜', 'ì°¨ë¶„í•˜ê³  ì§€ì ì¸ ë‚˜'ë¥¼ í‘œí˜„í•˜ê³  ì‹¶ìŠµë‹ˆë‹¤."></textarea>

            <button class="btn-report" onclick="showReport()">ğŸ“„ ê¸°íš ë³´ê³ ì„œ ë°œí–‰</button>
        </div>

        <div class="stage-box">
            <div class="spotlight" id="spotlight"></div>
            <div class="character-container" id="character">
                <div class="head"><div class="hair"></div></div>
                <div class="body-torso" id="displayTop">
                    <div class="arm-left"></div><div class="arm-right"></div>
                </div>
                <div class="legs" id="displayBottom"></div>
            </div>
            <div id="musicStatus">ğŸµ Music On Air... ğŸµ</div>
        </div>
    </div>

    <div class="modal-overlay" id="reportModal">
        <div class="report-card" id="printArea">
            <span class="close-btn" onclick="closeReport()">&times;</span>
            <h2>âœ¨ EAIM ëŸ°ì›¨ì´ ê¸°íš ë³´ê³ ì„œ âœ¨</h2>
            
            <div class="report-item">
                <span class="report-label">1. ì„¤ì • ìƒí™© (TPO) & ìŠ¤íƒ€ì¼</span>
                <div class="report-content" id="reportBasic"></div>
            </div>

            <div class="report-item">
                <span class="report-label">2. ìŠ¤íƒ€ì¼ë§ ê¸°íš ì˜ë„ (Artscape)</span>
                <div class="report-content" id="reportTPOContent"></div>
            </div>

            <div class="report-item">
                <span class="report-label">3. ìŒì•… ì—°ì¶œ ì˜ë„ (Musicalization)</span>
                <div class="report-content" id="reportMusicContent"></div>
            </div>

            <div class="report-item">
                <span class="report-label">4. ìµœì¢… í‘œí˜„ ëª©í‘œ (My Vibe)</span>
                <div class="report-content" id="reportVibeContent"></div>
            </div>

            <div style="text-align: center; margin-top: 20px; color: #888; font-size: 0.8rem; border-top:1px solid #eee; padding-top:10px;">
                Designed by Student Director | EAIM Studio
            </div>

            <div class="report-actions">
                <button class="btn-action btn-print" onclick="window.print()">ğŸ–¨ï¸ ì¸ì‡„ / PDF ì €ì¥</button>
                <button class="btn-action btn-save" onclick="saveReportImage()">ğŸ’¾ ì´ë¯¸ì§€ë¡œ ì €ì¥</button>
            </div>
        </div>
    </div>

    <script>
        function searchPinterest() {
            const keyword = document.getElementById('pinSearch').value;
            if (keyword) {
                const url = `https://www.pinterest.co.kr/search/pins/?q=${encodeURIComponent(keyword)}`;
                window.open(url, '_blank');
            } else {
                alert("ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!");
            }
        }

        function changeClothes() {
            const topVal = document.getElementById('topColor').value;
            const botVal = document.getElementById('bottomColor').value;
            document.getElementById('displayTop').style.background = topVal;
            document.getElementById('displayBottom').style.background = botVal;
        }

        function checkTPO() {
            const tpo = document.getElementById('tpoSelect').value;
            const tipBox = document.getElementById('tipBox');
            let msg = "";
            let searchKey = "";

            if (tpo === "school") { msg = "Tip: í™œë™ì„±ì´ ì¢‹ê³  ë‹¨ì •í•œ ìŠ¤ì¿¨ë£©"; searchKey = "10ëŒ€ ìŠ¤ì¿¨ë£© ì½”ë””"; }
            else if (tpo === "date") { msg = "Tip: ì‚¬ë‘ìŠ¤ëŸ½ê±°ë‚˜ ê¹”ë”í•œ ë°ì´íŠ¸ë£©"; searchKey = "ì£¼ë§ ë°ì´íŠ¸ ì½”ë””"; }
            else if (tpo === "party") { msg = "Tip: ì¡°ëª… ì•„ë˜ ë¹›ë‚˜ëŠ” í™”ë ¤í•œ íŒŒí‹°ë£©"; searchKey = "í•˜ì´í‹´ íŒŒí‹°ë£©"; }
            else if (tpo === "interview") { msg = "Tip: ì‹ ë¢°ê°ì„ ì£¼ëŠ” ì°¨ë¶„í•œ ì •ì¥ë£©"; searchKey = "í•™ìƒ ë©´ì ‘ ë³µì¥"; }
            
            if (msg) {
                tipBox.style.display = "block"; tipBox.innerText = msg;
                document.getElementById('pinSearch').value = searchKey;
            } else {
                tipBox.style.display = "none";
            }
        }

        function startRunway() {
            const fileInput = document.getElementById('musicFile');
            const player = document.getElementById('audioPlayer');
            const char = document.getElementById('character');
            const spotlight = document.getElementById('spotlight');
            const musicStatus = document.getElementById('musicStatus');

            if (!fileInput.files[0]) {
                alert("âš ï¸ Suno ìŒì•… íŒŒì¼ì„ ë¨¼ì € ë„£ì–´ì£¼ì„¸ìš”!"); return;
            }

            const fileUrl = URL.createObjectURL(fileInput.files[0]);
            player.src = fileUrl; player.volume = 0.8; player.play();

            char.classList.remove('walking-animation');
            void char.offsetWidth;
            char.classList.add('walking-animation');

            spotlight.style.opacity = 1;
            musicStatus.style.display = "block";

            setTimeout(() => {
                spotlight.style.opacity = 0; musicStatus.style.display = "none";
            }, 8000);
        }

        // ë³´ê³ ì„œ ë³´ê¸°
        function showReport() {
            const tpoSelect = document.getElementById('tpoSelect');
            const tpoText = tpoSelect.options[tpoSelect.selectedIndex].text;
            
            const topSel = document.getElementById('topColor');
            const botSel = document.getElementById('bottomColor');
            const topText = topSel.options[topSel.selectedIndex].text;
            const botText = botSel.options[botSel.selectedIndex].text;

            const val_tpo = document.getElementById('essay_tpo').value;
            const val_music = document.getElementById('essay_music').value;
            const val_vibe = document.getElementById('essay_vibe').value;

            if(tpoSelect.value === "") { alert("TPOë¥¼ ë¨¼ì € ì„ íƒí•´ì£¼ì„¸ìš”!"); return; }
            if(val_tpo.trim() === "" || val_music.trim() === "" || val_vibe.trim() === "") { 
                alert("ë””ìì´ë„ˆ ë…¸íŠ¸(ê¸°íšì„œ) ë‚´ìš©ì„ ëª¨ë‘ ì‘ì„±í•´ì£¼ì„¸ìš”!"); return; 
            }

            document.getElementById('reportBasic').innerText = `ìƒí™©: ${tpoText} / ì˜ìƒ: ${topText} & ${botText}`;
            document.getElementById('reportTPOContent').innerText = val_tpo;
            document.getElementById('reportMusicContent').innerText = val_music;
            document.getElementById('reportVibeContent').innerText = val_vibe;

            document.getElementById('reportModal').style.display = "flex";
        }

        function closeReport() {
            document.getElementById('reportModal').style.display = "none";
        }

        // [ì¶”ê°€] ì´ë¯¸ì§€ ì €ì¥ í•¨ìˆ˜
        function saveReportImage() {
            const reportElement = document.getElementById("printArea");
            
            // ìº¡ì²˜ ì „ì— ë‹«ê¸° ë²„íŠ¼ê³¼ ì•¡ì…˜ ë²„íŠ¼ì„ ì„ì‹œë¡œ ìˆ¨ê¹€ (ê¹”ë”í•œ ì €ì¥ì„ ìœ„í•´)
            const closeBtn = document.querySelector('.close-btn');
            const actions = document.querySelector('.report-actions');
            closeBtn.style.display = 'none';
            actions.style.display = 'none';

            html2canvas(reportElement).then(canvas => {
                const link = document.createElement("a");
                document.body.appendChild(link);
                link.download = "ë‚˜ì˜_ëŸ°ì›¨ì´_ê¸°íšì„œ.png";
                link.href = canvas.toDataURL("image/png");
                link.target = '_blank';
                link.click();
                document.body.removeChild(link);

                // ë‹¤ì‹œ ë²„íŠ¼ë“¤ ë³´ì´ê²Œ ë³µêµ¬
                closeBtn.style.display = 'block';
                actions.style.display = 'flex';
            });
        }

        // ì´ˆê¸°í™”
        changeClothes();
    </script>
</body>
</html>